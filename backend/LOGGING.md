# üìã –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω-—Å–∏—Å—Ç–µ–º–µ (SCADA Mobile Backend)

> –î–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç **–≤—Å—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è** –æ—Ç —Ç–µ–æ—Ä–∏–∏ –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.
> –†–∞—Å—Å—á–∏—Ç–∞–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Å 10‚Äì20 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∫–ª–∏–µ–Ω—Ç–∞–º–∏, —Ä–∞–±–æ—Ç–∞—é—â–∏–π 24/7.

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ó–∞—á–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —á—Ç–æ –≤ –Ω—ë–º –≥–ª–∞–≤–Ω–æ–µ](#1-–∑–∞—á–µ–º-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ-–∏-—á—Ç–æ-–≤-–Ω—ë–º-–≥–ª–∞–≤–Ω–æ–µ)
2. [–£—Ä–æ–≤–Ω–∏ –ª–æ–≥–æ–≤: —á—Ç–æ –∏ –∫–æ–≥–¥–∞ –ø–∏—Å–∞—Ç—å](#2-—É—Ä–æ–≤–Ω–∏-–ª–æ–≥–æ–≤-—á—Ç–æ-–∏-–∫–æ–≥–¥–∞-–ø–∏—Å–∞—Ç—å)
3. [–ß—Ç–æ –ù–ï–õ–¨–ó–Ø –ø–∏—Å–∞—Ç—å –≤ –ª–æ–≥–∏](#3-—á—Ç–æ-–Ω–µ–ª—å–∑—è-–ø–∏—Å–∞—Ç—å-–≤-–ª–æ–≥–∏)
4. [Logback: –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞](#4-logback-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–¥–ª—è-—ç—Ç–æ–≥–æ-–ø—Ä–æ–µ–∫—Ç–∞)
5. [–†–æ—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ](#5-—Ä–æ—Ç–∞—Ü–∏—è-—Ñ–∞–π–ª–æ–≤-–∏-—Ö—Ä–∞–Ω–µ–Ω–∏–µ)
6. [–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ (JSON) ‚Äî –ø–æ—á–µ–º—É –∏ –∫–∞–∫](#6-—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ-–ª–æ–≥–∏-json--–ø–æ—á–µ–º—É-–∏-–∫–∞–∫)
7. [MDC: –ø—Ä–∏–≤—è–∑–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∫ –ø–æ—Ç–æ–∫—É](#7-mdc-–ø—Ä–∏–≤—è–∑–∫–∞-–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞-–∫-–ø–æ—Ç–æ–∫—É)
8. [–ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∏ –∫–∞–∫ —ç—Ç–æ —É—Å—Ç—Ä–æ–µ–Ω–æ](#8-—á—Ç–æ-–ª–æ–≥–∏—Ä—É–µ—Ç-—ç—Ç–æ—Ç-–ø—Ä–æ–µ–∫—Ç-–∏-–∫–∞–∫-—ç—Ç–æ-—É—Å—Ç—Ä–æ–µ–Ω–æ)
9. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ –ø—Ä–æ—Ñ–∏–ª—è–º (dev / prod)](#9-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-–ø–æ-–ø—Ä–æ—Ñ–∏–ª—è–º-dev--prod)
10. [–ë—ã—Å—Ç—Ä—ã–π —á–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º](#10-–±—ã—Å—Ç—Ä—ã–π-—á–µ–∫–ª–∏—Å—Ç-–ø–µ—Ä–µ–¥-–¥–µ–ø–ª–æ–µ–º)

---

## 1. –ó–∞—á–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —á—Ç–æ –≤ –Ω—ë–º –≥–ª–∞–≤–Ω–æ–µ

–í –ø—Ä–æ–¥–∞–∫—à–Ω-—Å–∏—Å—Ç–µ–º–µ –ª–æ–≥–∏ ‚Äî —ç—Ç–æ **–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–æ–Ω—è—Ç—å, —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ** –ø—Ä–∏ —Å–±–æ–µ.  
–ü—Ä–∏ 10‚Äì20 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞—Ö –∑–∞ –æ–¥–Ω—É –º–∏–Ω—É—Ç—É –º–æ–∂–µ—Ç –ø—Ä–∏–π—Ç–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ—Ç–µ–Ω –∑–∞–ø—Ä–æ—Å–æ–≤.  
–ë–µ–∑ –≥—Ä–∞–º–æ—Ç–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ –ø—Ä–æ–±–ª–µ–º–µ –±—É–¥–µ—Ç –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ.

**–¢—Ä–∏ –≥–ª–∞–≤–Ω—ã–µ —Ü–µ–ª–∏ –ª–æ–≥–æ–≤:**

| –¶–µ–ª—å            | –ü—Ä–∏–º–µ—Ä                                                              |
|-----------------|---------------------------------------------------------------------|
| **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** | ¬´PrintSrv —É–ø–∞–ª –≤ 03:14, reconnect –∑–∞–Ω—è–ª 40 —Å–µ–∫, –¥–∞–Ω–Ω—ã–µ –Ω–µ —Ç–µ—Ä—è–ª–∏—Å—å¬ª |
| **–ê—É–¥–∏—Ç**       | ¬´Unit 3 –±—ã–ª –∏–∑–º–µ–Ω—ë–Ω –≤ 11:40:05, –∫–æ–º–∞–Ω–¥–∞ –ø—Ä–∏—à–ª–∞ —Å IP 10.0.0.5¬ª       |
| **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**  | ¬´–ë—É—Ñ–µ—Ä –∑–∞–ø–æ–ª–Ω–µ–Ω 3 —Ä–∞–∑–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å ‚Äî –Ω—É–∂–Ω–æ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ¬ª      |

**–ì–ª–∞–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:**

- –õ–æ–≥–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **—á–∏—Ç–∞–µ–º—ã —á–µ–ª–æ–≤–µ–∫–æ–º** –ø—Ä–∏ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞.
- –õ–æ–≥–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã **—Ä–∞–∑–¥—É–≤–∞—Ç—å –¥–∏—Å–∫** ‚Äî —ç—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–∞–¥–µ–Ω–∏—é —Å–µ—Ä–≤–µ—Ä–∞.
- –õ–æ–≥–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã **—Ç–æ—Ä–º–æ–∑–∏—Ç—å** –æ—Å–Ω–æ–≤–Ω—É—é —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (I/O-bound –æ–ø–µ—Ä–∞—Ü–∏–∏).
- –õ–æ–≥–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã **—É—Ç–µ–∫–∞—Ç—å** –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã.

---

## 2. –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–æ–≤: —á—Ç–æ –∏ –∫–æ–≥–¥–∞ –ø–∏—Å–∞—Ç—å

Spring Boot + SLF4J + Logback –¥–∞—é—Ç 5 —É—Ä–æ–≤–Ω–µ–π. –ü–æ–Ω–∏–º–∞–Ω–∏–µ ‚Äî –æ—Å–Ω–æ–≤–∞ –≤—Å–µ–≥–æ.

| –£—Ä–æ–≤–µ–Ω—å | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å                                                                                                       | –ü—Ä–∏–º–µ—Ä—ã –∏–∑ —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞                                                |
|---------|--------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------|
| `ERROR` | **–ß—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å –∏ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è**. –û–ø–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–∞–ª–∏–ª–∞—Å—å, –¥–∞–Ω–Ω—ã–µ –ø–æ—Ç–µ—Ä—è–Ω—ã, —Å–∏—Å—Ç–µ–º–∞ –≤ –∞–Ω–æ–º–∞–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏.          | WRITE –≤ PrintSrv —É–ø–∞–ª, –∫–æ–º–∞–Ω–¥—ã –ø–æ—Ç–µ—Ä—è–Ω—ã; reconnect –∏—Å—á–µ—Ä–ø–∞–ª –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏ |
| `WARN`  | **–ù–µ–Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è, –Ω–æ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É**. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞, –∫–æ—Ç–æ—Ä—É—é —Å—Ç–æ–∏—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å.                | –ü–æ—Ç–µ—Ä—è–Ω—ã –∫–æ–º–∞–Ω–¥—ã –¥–ª—è units; —Å—Çale snapshot (PrintSrv –¥–∞–≤–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)  |
| `INFO`  | **–í–∞–∂–Ω—ã–µ –±–∏–∑–Ω–µ—Å-—Å–æ–±—ã—Ç–∏—è –≤ —à—Ç–∞—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ**. –ó–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞, —Å–º–µ–Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –∑–Ω–∞—á–∏–º—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.                        | –ü–µ—Ä–≤—ã–π snapshot –ø–æ–ª—É—á–µ–Ω; PrintSrv reconnected; —Å—Ç–∞—Ä—Ç/—Å—Ç–æ–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è    |
| `DEBUG` | **–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –æ—Ç–ª–∞–¥–∫–∏**. –í –ø—Ä–æ–¥–µ ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ (–≤–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ –ª–µ—Ç—É). | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–º–∞–Ω–¥—ã; –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ units –≤ snapshot; —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞          |
| `TRACE` | **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏**. –ö–∞–∂–¥—ã–π –±–∞–π—Ç/—à–∞–≥. –í –ø—Ä–æ–¥–µ –ø–æ—á—Ç–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –Ω—É–∂–µ–Ω.                                                | –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–∫–µ—Ç–∞; —à–∞–≥–∏ scan cycle; –±–∞–π—Ç—ã —Ñ—Ä–µ–π–º–∞                 |

### –ü—Ä–∞–≤–∏–ª–æ –±–æ–ª—å—à–æ–≥–æ –ø–∞–ª—å—Ü–∞ –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

```
PROD:  root=WARN, backend=INFO
DEV:   root=INFO, backend=DEBUG, polling=TRACE
```

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–µ –≤ –ø—Ä–æ–¥–µ –º–æ–∂–Ω–æ **–≤—Ä–µ–º–µ–Ω–Ω–æ** –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å `backend=DEBUG` —á–µ—Ä–µ–∑ `application-prod.yaml`  
–∏–ª–∏ —á–µ—Ä–µ–∑ Spring Boot Actuator `/actuator/loggers/{name}` (–±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞).

### –ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω—ã —É—Ä–æ–≤–Ω–µ–π

```java
// ‚ùå –ü–õ–û–•–û ‚Äî INFO –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å (–ø—Ä–∏ 20 –∫–ª–∏–µ–Ω—Ç–∞—Ö = —Ç—ã—Å—è—á–∏ —Å—Ç—Ä–æ–∫/–º–∏–Ω)
log.info("Received GET /queryAll request");
log.

info("Returning QueryAll response");

// ‚úÖ –•–û–†–û–®–û ‚Äî DEBUG –¥–ª—è —á–∞—Å—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, INFO ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–Ω–∞—á–∏–º—ã—Ö —Å–æ–±—ã—Ç–∏–π
log.

debug("Processing queryAll request");
log.

info("Snapshot first loaded: {} units",snapshot.getUnitCount()); // –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
```

---

## 3. –ß—Ç–æ –ù–ï–õ–¨–ó–Ø –ø–∏—Å–∞—Ç—å –≤ –ª–æ–≥–∏

### 3.1. –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–Ω–∞–ø—à–æ—Ç–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ INFO

```java
// ‚ùå –ó–ê–ü–†–ï–©–ï–ù–û ‚Äî –≥–∏–≥–∞–Ω—Ç—Å–∫–∏–π –æ–±—ä–µ–∫—Ç –≤ –ª–æ–≥–∞—Ö –Ω–∞ –∫–∞–∂–¥—ã–π —Ü–∏–∫–ª
log.info("Snapshot received: {}",snapshot.toString());

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û ‚Äî —Ç–æ–ª—å–∫–æ –º–µ—Ç—Ä–∏–∫–∏
    log.

debug("Snapshot updated: {} units, ts={}",snapshot.getUnitCount(),snapshot.

getTimestamp());
```

### 3.2. –°–µ–∫—Ä–µ—Ç—ã –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

```java
// ‚ùå –ó–ê–ü–†–ï–©–ï–ù–û
log.info("Connecting with credentials: user={}, password={}",user, pass);

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û ‚Äî –≤ —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –Ω–µ—Ç, –Ω–æ –ø—Ä–∞–≤–∏–ª–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ
log.

info("Connecting to PrintSrv: {}:{}",ip, port);
```

### 3.3. Stack trace –Ω–∞ —É—Ä–æ–≤–Ω–µ WARN/INFO

```java
// ‚ùå –ü–õ–û–•–û ‚Äî stack trace —Å–æ–∑–¥–∞—ë—Ç –æ–≥—Ä–æ–º–Ω—ã–µ –±–ª–æ–∫–∏
log.warn("Connection lost",exception);

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û ‚Äî WARN –±–µ–∑ stack trace, ERROR ‚Äî —Å –Ω–∏–º
log.

warn("Connection lost: {}",exception.getMessage());
    log.

error("Unexpected error in scan cycle",exception); // –∑–¥–µ—Å—å stack trace –Ω—É–∂–µ–Ω
```

### 3.4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ü–∏–∫–ª–µ –±–µ–∑ rate limiting

```java
// ‚ùå –û–ü–ê–°–ù–û ‚Äî scan cycle –∫–∞–∂–¥—ã–µ N –º—Å, —ç—Ç–æ—Ç –ª–æ–≥ –±—É–¥–µ—Ç –ø–∏—Å–∞—Ç—å—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ
@Scheduled(fixedDelayString = "...")
public void scanCycle() {
    log.info("Scan cycle executing..."); // ‚Üê —Å–ø–∞–º
}

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û ‚Äî TRACE –∏–ª–∏ DEBUG; –∑–Ω–∞—á–∏–º—ã–µ —Å–æ–±—ã—Ç–∏—è –Ω–∞ INFO
log.

trace("Scan cycle start");
if(pendingWrites.

isEmpty()){
    log.

debug("No pending writes in this cycle");
}
```

---

## 4. Logback: –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

Spring Boot –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Logback** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –ë–∞–∑–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ YAML  
–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞–µ–≤, –Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –Ω—É–∂–µ–Ω `logback-spring.xml`.

### –ü–æ—á–µ–º—É `logback-spring.xml`, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ YAML?

| –§—É–Ω–∫—Ü–∏—è                            | YAML | logback-spring.xml  |
|------------------------------------|------|---------------------|
| –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–æ–≤ –ø–æ –ø–∞–∫–µ—Ç–∞–º            | ‚úÖ    | ‚úÖ                   |
| –†–æ—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –ø–æ —Ä–∞–∑–º–µ—Ä—É –∏ –¥–∞—Ç–µ   | ‚ùå    | ‚úÖ                   |
| –õ–∏–º–∏—Ç –Ω–∞ –æ–±—â–∏–π —Ä–∞–∑–º–µ—Ä –∞—Ä—Ö–∏–≤–æ–≤      | ‚ùå    | ‚úÖ                   |
| JSON-—Ñ–æ—Ä–º–∞—Ç –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ | ‚ùå    | ‚úÖ                   |
| –†–∞–∑–Ω—ã–µ appender –¥–ª—è dev/prod       | ‚ùå    | ‚úÖ                   |
| –£—Å–ª–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ Spring-–ø—Ä–æ—Ñ–∏–ª—é  | ‚ùå    | ‚úÖ (`springProfile`) |
| –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å (AsyncAppender) | ‚ùå    | ‚úÖ                   |

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞

```
src/main/resources/logback-spring.xml
```

–§–∞–π–ª —Ä–∞–∑–±–∏—Ç –Ω–∞ —á–∞—Å—Ç–∏:

1. **`CONSOLE` appender** ‚Äî —Ü–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å (—Ç–æ–ª—å–∫–æ dev)
2. **`FILE_JSON` appender** ‚Äî JSON-—Ñ–∞–π–ª –¥–ª—è prod (–º–∞—à–∏–Ω–æ—á–∏—Ç–∞–µ–º—ã–π)
3. **`FILE_PLAIN` appender** ‚Äî plain text —Ñ–∞–π–ª (dev/–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ)
4. **`ASYNC_FILE` appender** ‚Äî –æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ FILE –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏
5. **`springProfile dev`** ‚Äî –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è dev-–ø—Ä–æ—Ñ–∏–ª—è
6. **`springProfile prod`** ‚Äî –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è prod-–ø—Ä–æ—Ñ–∏–ª—è

> **–§–∞–π–ª `logback-spring.xml` —É–∂–µ —Å–æ–∑–¥–∞–Ω** –≤ `src/main/resources/` –∫–∞–∫ —á–∞—Å—Ç—å —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.

---

## 5. –†–æ—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ

–ë–µ–∑ —Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–∏ –∑–∞ –Ω–µ–¥–µ–ª—é —Ä–∞–±–æ—Ç—ã –∑–∞–π–º—É—Ç –≥–∏–≥–∞–±–∞–π—Ç—ã –∏ —É–±—å—é—Ç –¥–∏—Å–∫.

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

```
logs/
  backend.log              ‚Üê —Ç–µ–∫—É—â–∏–π plain text —Ñ–∞–π–ª (dev –ø—Ä–æ—Ñ–∏–ª—å)
  backend.json             ‚Üê —Ç–µ–∫—É—â–∏–π JSON —Ñ–∞–π–ª (prod –ø—Ä–æ—Ñ–∏–ª—å)
  archived/
    backend.2026-02-19.0.log.gz    ‚Üê –∞—Ä—Ö–∏–≤ dev
    backend.2026-02-19.0.json.gz   ‚Üê –∞—Ä—Ö–∏–≤ prod
    ...
```

–ü–æ–ª–∏—Ç–∏–∫–∞:

- –†–æ—Ç–∞—Ü–∏—è **–µ–∂–µ–¥–Ω–µ–≤–Ω–æ** + –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ **50 –ú–ë** (—á—Ç–æ –Ω–∞—Å—Ç—É–ø–∏—Ç —Ä–∞–Ω—å—à–µ)
- –•—Ä–∞–Ω–µ–Ω–∏–µ **–∞—Ä—Ö–∏–≤–æ–≤ –Ω–µ –±–æ–ª–µ–µ 30 –¥–Ω–µ–π**
- –û–±—â–∏–π –ª–∏–º–∏—Ç –Ω–∞ –≤—Å–µ –∞—Ä—Ö–∏–≤—ã: **500 –ú–ë**

–ï—Å–ª–∏ –¥–∏—Å–∫ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è ‚Äî —Å—Ç–∞—Ä—ã–µ –∞—Ä—Ö–∏–≤—ã —É–¥–∞–ª—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

### –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–≥–∏

- **–õ–æ–∫–∞–ª—å–Ω–æ**: `./logs/` (–∑–∞–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ `LOG_PATH` –∏–ª–∏ –≤ `logback-spring.xml`)
- **–ü—Ä–æ–¥–∞–∫—à–Ω**: —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è `/var/log/scada-backend/` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
- **–ù–∏–∫–æ–≥–¥–∞** –Ω–µ –ø–∏—à–∏—Ç–µ –ª–æ–≥–∏ –≤ `src/` –∏–ª–∏ —Ä—è–¥–æ–º —Å JAR-—Ñ–∞–π–ª–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## 6. –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ (JSON) ‚Äî –ø–æ—á–µ–º—É –∏ –∫–∞–∫

–í –ø—Ä–æ–¥–∞–∫—à–Ω-—Å–∏—Å—Ç–µ–º–∞—Ö plain text –ª–æ–≥–∏ –Ω–µ—É–¥–æ–±–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞—Ö.  
JSON –ø–æ–∑–≤–æ–ª—è–µ—Ç **—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å, –∏—Å–∫–∞—Ç—å, –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å** ‚Äî –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–±–æ—Ä.

### Plain text (dev)

```
2026-02-20 14:53:12.345 INFO  [scan-1] PrintSrvPollingScheduler - Scan cycle completed: 12 units updated
```

–ß–∏—Ç–∞–µ—Ç—Å—è —á–µ–ª–æ–≤–µ–∫–æ–º, –Ω–æ grep-–Ω—É—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –ø–æ–ª–µ —Å–ª–æ–∂–Ω–æ.

### JSON (prod)

```json
{
    "timestamp": "2026-02-20T14:53:12.345+03:00",
    "level": "INFO",
    "thread": "scheduling-1",
    "logger": "PrintSrvPollingScheduler",
    "message": "Scan cycle completed: 12 units updated",
    "application": "scada.mobile.backend",
    "profile": "prod"
}
```

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ: `grep '"level":"ERROR"' backend.log | jq .message`

### –ó–∞—á–µ–º —ç—Ç–æ –ø—Ä–∏ 10‚Äì20 –∫–ª–∏–µ–Ω—Ç–∞—Ö?

–ü—Ä–∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–µ –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤—Å–µ –æ—à–∏–±–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –º–∏–Ω—É—Ç –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É unit.  
–° JSON —ç—Ç–æ `jq`, —Å plain text ‚Äî —Å–ª–æ–∂–Ω—ã–π `awk/grep`. JSON-–ª–æ–≥–∏ ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç –∏–Ω–¥—É—Å—Ç—Ä–∏–∏.

---

## 7. MDC: –ø—Ä–∏–≤—è–∑–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∫ –ø–æ—Ç–æ–∫—É

MDC (Mapped Diagnostic Context) ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º SLF4J, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç  
**–¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –∫ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ –ª–æ–≥–∞ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —Ç–µ–∫—É—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞**.

### –ó–∞—á–µ–º –≤ —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ

–ü—Ä–∏ 10‚Äì20 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞—Ö –≤ –ª–æ–≥–∞—Ö –ø–µ—Ä–µ–º–µ—à–∞–Ω—ã —Å—Ç—Ä–æ–∫–∏ –æ—Ç —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤.  
MDC –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å `requestId` –∏ –ø–æ—Ç–æ–º –Ω–∞–π—Ç–∏ –≤–µ—Å—å –ø—É—Ç—å –æ–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:

```
2026-02-20 14:53:12 INFO  [http-5] [a1b2c3d4] CommandsController     : Received POST /setUnitVars
2026-02-20 14:53:12 DEBUG [http-5] [a1b2c3d4] CommandsService         : Processing setUnitVars: unit=3
2026-02-20 14:53:12 DEBUG [http-5] [a1b2c3d4] ScadaApplicationService : Command added to buffer
```

–ë–µ–∑ MDC —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏ —Å–º–µ—à–∞—é—Ç—Å—è —Å –ª–æ–≥–∞–º–∏ –æ—Ç –¥—Ä—É–≥–∏—Ö 19 –∫–ª–∏–µ–Ω—Ç–æ–≤.

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ

MDC —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —á–µ—Ä–µ–∑ –¥–≤–∞ –∫–ª–∞—Å—Å–∞ –≤ –ø–∞–∫–µ—Ç–µ `config`:

| –ö–ª–∞—Å—Å       | –†–æ–ª—å                                                                                    |
|-------------|-----------------------------------------------------------------------------------------|
| `MdcFilter` | `OncePerRequestFilter` ‚Äî —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏ **–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —á–∏—Å—Ç–∏—Ç** MDC –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å |
| `MdcConfig` | –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ñ–∏–ª—å—Ç—Ä —Å `Ordered.HIGHEST_PRECEDENCE` ‚Äî —Ä–∞–Ω—å—à–µ CORS –∏ Spring Security      |

### MDC-–ø–æ–ª—è

| –ö–ª—é—á        | –ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏—è           | –û–ø–∏—Å–∞–Ω–∏–µ                                         |
|-------------|---------------------------|--------------------------------------------------|
| `requestId` | `a1b2c3d4`                | 8-—Å–∏–º–≤–æ–ª—å–Ω—ã–π hex UUID (–∏–ª–∏ –≤–Ω–µ—à–Ω–∏–π X-Request-ID) |
| `method`    | `POST`                    | HTTP-–º–µ—Ç–æ–¥ –∑–∞–ø—Ä–æ—Å–∞                               |
| `uri`       | `/api/v1/.../setUnitVars` | URI –∑–∞–ø—Ä–æ—Å–∞ (–±–µ–∑ query string)                   |

> –î–ª—è scan cycle, shutdown-–ø–æ—Ç–æ–∫–æ–≤ –∏ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á MDC-–ø–æ–ª—è **–ø—É—Å—Ç—ã** ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ,  
> —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –Ω–µ —è–≤–ª—è—é—Ç—Å—è HTTP-–∑–∞–ø—Ä–æ—Å–∞–º–∏.

### X-Request-ID: –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å –∫–ª–∏–µ–Ω—Ç–æ–º –∏ reverse proxy

–§–∏–ª—å—Ç—Ä —É–º–µ–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å `X-Request-ID` –∏–∑ –≤—Ö–æ–¥—è—â–µ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç nginx):

```
# nginx –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Å–≤–æ–π request ID:
proxy_set_header X-Request-ID $request_id;
```

–¢–æ—Ç –∂–µ `requestId` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ –æ—Ç–≤–µ—Ç–∞ ‚Äî –∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ  
–Ω–∞ —Å–≤–æ–µ–π —Å—Ç–æ—Ä–æ–Ω–µ –∏ —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–Ω—ã–º–∏ –ª–æ–≥–∞–º–∏ –ø—Ä–∏ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º—ã.

**–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–µ–≥–æ ID** (–∑–∞—â–∏—Ç–∞ –æ—Ç –∏–Ω—ä–µ–∫—Ü–∏–π –≤ –ª–æ–≥–∏):

- –¢–æ–ª—å–∫–æ —Å–∏–º–≤–æ–ª—ã `[a-zA-Z0-9\-_]`
- –î–ª–∏–Ω–∞ –Ω–µ –±–æ–ª–µ–µ 64 —Å–∏–º–≤–æ–ª–æ–≤
- –ï—Å–ª–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–≤–æ–π

### –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å MDC –≤ Spring Boot

–°–æ–∑–¥–∞—ë—Ç—Å—è `Filter` –∏–ª–∏ `HandlerInterceptor`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ:

1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `requestId` (UUID –∏–ª–∏ –∫–æ—Ä–æ—Ç–∫–∏–π hash)
2. –ö–ª–∞–¥—ë—Ç –µ–≥–æ –≤ `MDC.put("requestId", id)`
3. –ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ ‚Äî `MDC.clear()`

```java
// –ü—Ä–∏–º–µ—Ä ‚Äî —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ MdcFilter:
try {
    MDC.put("requestId", resolveRequestId(request));
    MDC.put("method", request.getMethod());
    MDC.put("uri", request.getRequestURI());
    filterChain.doFilter(request, response);
} finally {
    MDC.remove("requestId");   // ‚Üê –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤ finally
    MDC.remove("method");
    MDC.remove("uri");
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –ø–∞—Ç—Ç–µ—Ä–Ω–µ logback

–í `logback-spring.xml` –¥–æ–±–∞–≤–ª–µ–Ω–æ `%X{requestId:-        }` –≤ –ø–∞—Ç—Ç–µ—Ä–Ω:

```
# Plain text (dev):
2026-02-20 15:00:01.123 INFO  [http-1] [a1b2c3d4] CommandsController : SetUnitVars accepted

# JSON (prod) ‚Äî JsonEncoder –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ MDC-–ø–æ–ª—è:
{"requestId":"a1b2c3d4","method":"POST","uri":"/api/v1/commands/setUnitVars","level":"INFO",...}
```

–î–ª—è —Å—Ç—Ä–æ–∫ **–≤–Ω–µ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤** (scan cycle, —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏) `requestId` ‚Äî –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞,  
—á—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç –∏—Ö –æ—Ç –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

---

## 8. –ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∏ –∫–∞–∫ —ç—Ç–æ —É—Å—Ç—Ä–æ–µ–Ω–æ

### –ö–∞—Ä—Ç–∞ —Å–æ–±—ã—Ç–∏–π –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç                   | ERROR                                     | WARN                                 | INFO                                          | DEBUG/TRACE                           |
|-----------------------------|-------------------------------------------|--------------------------------------|-----------------------------------------------|---------------------------------------|
| `CommandsController`        | ‚Äî                                         | ‚Äî                                    | ‚Äî                                             | –í—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã queryAll/setUnitVars |
| `CommandsService`           | ‚Äî                                         | ‚Äî                                    | –°—Ç–∞—Ä—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞                              | –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤                    |
| `ScadaApplicationService`   | ‚Äî                                         | Snapshot –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω                  | –°—Ç–∞—Ä—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞                              | –ß—Ç–µ–Ω–∏–µ snapshot, –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ –±—É—Ñ–µ—Ä   |
| `PrintSrvPollingScheduler`  | –ü—Ä–æ–≤–∞–ª WRITE (–ø–æ—Ç–µ—Ä—è –∫–æ–º–∞–Ω–¥)              | ‚Äî                                    | –°—Ç–∞—Ä—Ç, –∏–Ω—Ç–µ—Ä–≤–∞–ª —Ü–∏–∫–ª–∞                         | –ù–µ—Ç pending writes                    |
| `PrintSrvConnectionManager` | –ò—Å—á–µ—Ä–ø–∞–Ω—ã retry, –Ω–µ—Ç reconnect            | –ü–µ—Ä–µ—Ö–æ–¥ –≤ recovery mode              | –£—Å–ø–µ—à–Ω—ã–π reconnect                            | –ü–æ–ø—ã—Ç–∫–∏ retry, backoff delays         |
| `SocketManager`             | –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ             | ‚Äî                                    | –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ / –∑–∞–∫—Ä—ã—Ç–æ –ø—Ä–∏ shutdown | –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–∫–µ—Ç–∞              |
| `PrintSrvSnapshotStore`     | ‚Äî                                         | ‚Äî                                    | –ü–µ—Ä–≤—ã–π snapshot —Å–æ—Ö—Ä–∞–Ω—ë–Ω                      | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ snapshot                   |
| `PendingCommandsBuffer`     | ‚Äî                                         | –ë—É—Ñ–µ—Ä –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω (–ø–µ—Ä–µ–¥ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º) | ‚Äî                                             | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥          |
| `GlobalExceptionHandler`    | –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ 5xx –æ—à–∏–±–∫–∏ (—Å–æ stacktrace) | ‚Äî                                    | ‚Äî                                             | 4xx –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –æ—à–∏–±–∫–∏                 |

### –ü—Ä–æ–±–ª–µ–º—ã –≤ —Ç–µ–∫—É—â–µ–º –∫–æ–¥–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å

#### ‚ùå `log.info` –Ω–∞ –∫–∞–∂–¥—ã–π –≤—Ö–æ–¥—è—â–∏–π –∑–∞–ø—Ä–æ—Å (CommandsController)

```java
// –¢–µ–∫—É—â–∏–π –∫–æ–¥ ‚Äî –ø–ª–æ—Ö–æ –¥–ª—è prod –ø—Ä–∏ 10‚Äì20 –∫–ª–∏–µ–Ω—Ç–∞—Ö:
log.info("Received GET /queryAll request");      // ‚Üê –ø—Ä–∏ 500 –º—Å —Ü–∏–∫–ª–µ = —Ç—ã—Å—è—á–∏ —Å—Ç—Ä–æ–∫/–º–∏–Ω
log.

info("Returning QueryAll response");

// –ù—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ DEBUG:
log.

debug("Processing queryAll request");
```

#### ‚ùå `log.info` –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–≥–æ bean-–∞

```java
// –¢–µ–∫—É—â–∏–π –∫–æ–¥ –≤–æ –º–Ω–æ–≥–∏—Ö –∫–ª–∞—Å—Å–∞—Ö:
log.info("CommandsService initialized with clean architecture design");
log.

info("QueryAllCommand initialized");
log.

info("SetUnitVars command initialized");

// –í prod —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —à—É–º. –ù—É–∂–Ω–æ DEBUG –∏–ª–∏ —É–±—Ä–∞—Ç—å —Å–æ–≤—Å–µ–º
// –û—Å—Ç–∞–≤–∏—Ç—å INFO —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É –≤–∞–∂–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π —Å—Ç–∞—Ä—Ç–∞
```

#### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –Ω–∞ INFO

```java
log.info("PrintSrvPollingScheduler initialized - scan cycle interval: {}ms",pollingFixedDelayMs);
log.

info("First snapshot saved with {} units",snapshot.getUnitCount());
    log.

info("‚úÖ Socket connection established successfully to {}:{}",IP, PORT);
```

---

## 9. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ –ø—Ä–æ—Ñ–∏–ª—è–º (dev / prod)

### `logback-spring.xml` ‚Äî –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–§–∞–π–ª –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `src/main/resources/logback-spring.xml`.  
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç `<springProfile>` –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–æ–≤–µ–¥–µ–Ω–∏–π:

**Dev –ø—Ä–æ—Ñ–∏–ª—å:**

- –í—ã–≤–æ–¥ –≤ **–∫–æ–Ω—Å–æ–ª—å** —Å —Ü–≤–µ—Ç–∞–º–∏
- –í—ã–≤–æ–¥ –≤ **plain text —Ñ–∞–π–ª** –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è
- –£—Ä–æ–≤–µ–Ω—å `DEBUG` –¥–ª—è –∫–æ–¥–∞ –ø—Ä–æ–µ–∫—Ç–∞

**Prod –ø—Ä–æ—Ñ–∏–ª—å:**

- **–ù–µ—Ç –≤—ã–≤–æ–¥–∞ –≤ –∫–æ–Ω—Å–æ–ª—å** (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç CPU –ø—Ä–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ systemd/docker)
- –í—ã–≤–æ–¥ –≤ **JSON —Ñ–∞–π–ª** —Å —Ä–æ—Ç–∞—Ü–∏–µ–π
- **AsyncAppender** ‚Äî –∑–∞–ø–∏—Å—å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ—Ç–æ–∫–∏)
- –£—Ä–æ–≤–µ–Ω—å `INFO` –¥–ª—è –∫–æ–¥–∞ –ø—Ä–æ–µ–∫—Ç–∞, `WARN` –¥–ª—è –≤—Å–µ–≥–æ –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã –¥–ª—è prod

```bash
# –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—É—Ç—å –∫ –ª–æ–≥–∞–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, /var/log/scada)
LOG_PATH=/var/log/scada-backend

# –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ (—á–µ—Ä–µ–∑ Actuator)
# POST /actuator/loggers/dev.savushkin.scada.mobile.backend
# {"configuredLevel": "DEBUG"}
```

### `application-prod.yaml` ‚Äî —É—Ä–æ–≤–Ω–∏ –ª–æ–≥–æ–≤

```yaml
logging:
    level:
        root: WARN
        dev.savushkin.scada.mobile.backend: INFO
        # –í—Ä–µ–º–µ–Ω–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –≤ –ø—Ä–æ–¥–µ (–ø–æ—Ç–æ–º —É–±—Ä–∞—Ç—å):
        # dev.savushkin.scada.mobile.backend.infrastructure.polling: DEBUG
```

---

## 10. –ë—ã—Å—Ç—Ä—ã–π —á–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- [ ] `logback-spring.xml` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ `src/main/resources/`
- [ ] Prod-–ø—Ä–æ—Ñ–∏–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **JSON appender** —Å —Ä–æ—Ç–∞—Ü–∏–µ–π
- [ ] Prod-–ø—Ä–æ—Ñ–∏–ª—å **–Ω–µ –ø–∏—à–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª—å** (—Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª)
- [ ] `AsyncAppender` –≤–∫–ª—é—á—ë–Ω –≤ prod –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- [ ] –ü—É—Ç—å –∫ –ª–æ–≥–∞–º —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∑–∞–ø–∏—Å–∏ (`LOG_PATH`)
- [ ] –†–æ—Ç–∞—Ü–∏—è: –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞, –º–∞–∫—Å–∏–º—É–º –¥–Ω–µ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è, –ª–∏–º–∏—Ç –Ω–∞ –æ–±—â–∏–π —Ä–∞–∑–º–µ—Ä

### –£—Ä–æ–≤–Ω–∏

- [ ] Prod: `root=WARN`, `backend=INFO`
- [ ] –ß–∞—Å—Ç—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (queryAll, scan cycle) ‚Äî `DEBUG`, –Ω–µ `INFO`
- [ ] –û—à–∏–±–∫–∏ PrintSrv ‚Äî `ERROR` —Å–æ stacktrace
- [ ] Recovery mode / skipped cycles ‚Äî `TRACE`, –Ω–µ `ERROR` (–Ω–µ —Å–ø–∞–º)
- [ ] –ù–µ—Ç `log.info` —Å –ø–æ–ª–Ω—ã–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º snapshot

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- [ ] –ù–µ—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤/–ø–∞—Ä–æ–ª–µ–π –≤ –ª–æ–≥–∞—Ö
- [ ] –ù–µ—Ç IP –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ –ª–æ–≥–∞—Ö –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- [ ] –§–∞–π–ª—ã –ª–æ–≥–æ–≤ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ HTTP (Swagger –æ—Ç–∫–ª—é—á–µ–Ω –≤ prod)

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: Spring Boot Actuator –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∞–º–∏ –≤ —Ä–∞–Ω—Ç–∞–π–º–µ

Spring Boot Actuator (—É–∂–µ –µ—Å—Ç—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö) –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–µ–Ω—è—Ç—å —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–æ–≤ **–±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞**:

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –ø–∞–∫–µ—Ç–∞
GET /actuator/loggers/dev.savushkin.scada.mobile.backend

# –í–∫–ª—é—á–∏—Ç—å DEBUG –¥–ª—è —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞
POST /actuator/loggers/dev.savushkin.scada.mobile.backend
Content-Type: application/json
{"configuredLevel": "DEBUG"}

# –í–µ—Ä–Ω—É—Ç—å –æ–±—Ä–∞—Ç–Ω–æ
POST /actuator/loggers/dev.savushkin.scada.mobile.backend
Content-Type: application/json
{"configuredLevel": "INFO"}
```

> ‚ö†Ô∏è –í prod **Actuator endpoints –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–∫—Ä—ã—Ç—ã** –æ—Ç –≤–Ω–µ—à–Ω–µ–π —Å–µ—Ç–∏ –∏–ª–∏ –∑–∞—â–∏—â–µ–Ω—ã.  
> –î–æ–±–∞–≤—å—Ç–µ –≤ `application-prod.yaml`:
> ```yaml
> management:
>   endpoints:
>     web:
>       exposure:
>         include: "health,loggers"
>   server:
>     port: 8081   # –û—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ—Ä—Ç, –∑–∞–∫—Ä—ã—Ç—ã–π —Ñ–∞–π—Ä–≤–æ–ª–ª–æ–º
> ```

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2026-02-20*


