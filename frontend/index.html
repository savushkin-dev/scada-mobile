<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Мониторинг: «Савушкин продукт» (Брест)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F9FA;
            color: #1A1C1E;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        .card {
            background: #FFFFFF;
            border-radius: 24px;
            box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.03);
            border: 2px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .card:active { transform: scale(0.98); }

        .status-normal { 
            border-color: #34A853; 
            background-color: #F4FBF6;
        }
        
        .status-warning { 
            border-color: #FBBC04; 
            background-color: #FFFDF5;
            animation: border-pulse-warning 2s infinite;
        }

        .status-critical { 
            border-color: #EA4335; 
            background-color: #FFF5F5;
            animation: border-pulse-critical 2s infinite;
        }

        @keyframes border-pulse-warning {
            0% { border-color: rgba(251, 188, 4, 1); }
            50% { border-color: rgba(251, 188, 4, 0.3); }
            100% { border-color: rgba(251, 188, 4, 1); }
        }

        @keyframes border-pulse-critical {
            0% { border-color: rgba(234, 67, 53, 1); }
            50% { border-color: rgba(234, 67, 53, 0.3); }
            100% { border-color: rgba(234, 67, 53, 1); }
        }

        .screen {
            display: none;
            min-height: 100vh;
            padding-bottom: 40px;
        }
        .screen.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="max-w-md mx-auto">

    <!-- SCREEN 1: DASHBOARD -->
    <section id="screen-dashboard" class="screen active">
        <header class="p-6 flex justify-between items-start mt-4">
            <div>
                <p class="text-[10px] font-bold tracking-wider text-[#74777F] uppercase mb-1">Площадка г. Брест</p>
                <h1 class="text-2xl font-bold text-[#1A1C1E]">Савушкин продукт</h1>
            </div>
        </header>

        <main class="px-4 space-y-4">
            <div class="card status-normal p-5" onclick="showWorkshop('Аппаратный')">
                <h2 class="text-xl font-bold mb-1">Аппаратный цех</h2>
                <div class="flex justify-between items-end">
                    <div class="space-y-1">
                        <p class="text-xs text-gray-500 font-medium">Танки хранения: <span class="text-gray-900">18</span></p>
                        <p class="text-xs text-gray-500 font-medium">Проблемных: <span class="text-gray-900">0</span></p>
                    </div>
                    <span class="text-[10px] font-bold text-green-700 uppercase tracking-tight bg-green-100 px-2 py-1 rounded-md">В норме</span>
                </div>
            </div>

            <div class="card status-warning p-5" onclick="showWorkshop('ЦМП')">
                <h2 class="text-xl font-bold mb-1">Цех розлива (ЦМП)</h2>
                <div class="flex justify-between items-end">
                    <div class="space-y-1">
                        <p class="text-xs text-gray-500 font-medium">Линии розлива: <span class="text-gray-900">12</span></p>
                        <p class="text-xs text-gray-500 font-medium">Проблемных: <span class="text-amber-600 font-bold">1</span></p>
                    </div>
                    <span class="text-[10px] font-bold text-amber-700 uppercase tracking-tight bg-amber-100 px-2 py-1 rounded-md">Внимание</span>
                </div>
            </div>


        </main>
    </section>

    <!-- SCREEN 2: WORKSHOP UNITS -->
    <section id="screen-workshop" class="screen">
        <header class="p-6 flex items-center gap-4 mt-4">
            <button onclick="navigate('dashboard')" class="p-2 hover:bg-gray-100 rounded-full">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
            </button>
            <h1 id="workshop-title" class="text-xl font-bold text-[#1A1C1E] break-words">Цех</h1>
        </header>

        <main class="px-4 space-y-3" id="units-list">
            <!-- Content dynamicly injected -->
        </main>
    </section>

    <!-- SCREEN 3: EVENT DETAILS -->
    <section id="screen-details" class="screen">
        <header class="p-6 flex items-center gap-4 mt-4">
            <button onclick="navigate('workshop')" class="p-2 hover:bg-gray-100 rounded-full">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
            </button>
            <h1 class="text-2xl font-bold text-[#1A1C1E]">Инцидент</h1>
        </header>

        <main class="px-6 space-y-6">
            <div>
                <h2 id="event-unit" class="text-xl font-bold text-gray-900 leading-tight">Установка</h2>
                <div id="event-badge" class="mt-2 inline-block px-3 py-1 text-[10px] font-bold rounded-full uppercase tracking-wider">Статус</div>
            </div>

            <div class="space-y-4">
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-white p-4 rounded-2xl border border-gray-100 shadow-sm">
                        <p class="text-[10px] text-gray-400 uppercase font-bold">Код ошибки</p>
                        <p class="text-lg font-bold" id="error-code">-</p>
                    </div>
                    <div class="bg-white p-4 rounded-2xl border border-gray-100 shadow-sm">
                        <p class="text-[10px] text-gray-400 uppercase font-bold">Начало</p>
                        <p class="text-lg font-bold" id="event-time">00:00:00</p>
                    </div>
                </div>

                <div class="bg-white p-4 rounded-2xl border border-gray-100 shadow-sm">
                    <p class="text-[10px] text-gray-400 uppercase font-bold">Техническая расшифровка</p>
                    <p id="event-desc" class="text-gray-700 mt-1 leading-snug text-sm font-medium">Описание...</p>
                </div>

                <div class="bg-white p-4 rounded-2xl border border-gray-100 shadow-sm flex justify-between items-center">
                    <div>
                        <p class="text-[10px] text-gray-400 uppercase font-bold">Мастер участка</p>
                        <p class="font-bold text-sm" id="event-responsible">-</p>
                    </div>
                    <div id="resp-avatar" class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 text-xs font-bold">??</div>
                </div>
            </div>

            <div class="space-y-3">
                <p class="text-xs font-bold text-gray-500 uppercase px-1">Хронология</p>
                <div class="border-l-2 border-gray-200 ml-4 space-y-6" id="event-log"></div>
            </div>
        </main>
    </section>

    <script>
        const brestFactoryData = {
            'Аппаратный': [
                { id: 101, unit: 'Танк T-01 (Сырое молоко)', status: 'Норма', event: 'Заполнение 85%', timer: '00:00:00', type: 'Normal' },
                { id: 102, unit: 'Сепаратор GEA Westfalia №2', status: 'Норма', event: 'Нормализация', timer: '00:00:00', type: 'Normal' },
                { id: 103, unit: 'Пастеризатор Tetra Pak P-04', status: 'Норма', event: '72°C - Стабильно', timer: '00:00:00', type: 'Normal' }
            ],
            'ЦМП': [
                { id: 201, unit: 'Линия розлива ПЭТ №1', status: 'Норма', event: 'Активен розлив', timer: '00:00:00', type: 'Normal' },
                { id: 202, unit: 'Автомат Tetra Top №5', status: 'Внимание', event: 'Замятие ленты крышек', timer: '00:05:44', type: 'Warning', code: 'W-CAP-12', desc: 'Замятие ленты с крышками на узле подачи. Требуется ручная очистка направляющих.', resp: 'Смирнов В.П.', initials: 'СП', log: [['15:10', 'Сбой подачи'], ['15:12', 'Предупреждение системы']] }
            ],

        };

        let currentWorkshopKey = '';

        function navigate(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(`screen-${screenId}`).classList.add('active');
            window.scrollTo(0,0);
        }

        function showWorkshop(key) {
            currentWorkshopKey = key;
            const titleMap = {
                'Аппаратный': 'Аппаратный цех',
                'ЦМП': 'Цех розлива (ЦМП)'
            };
            
            document.getElementById('workshop-title').innerText = titleMap[key] || key;
            const container = document.getElementById('units-list');
            container.innerHTML = '';

            if (brestFactoryData[key]) {
                brestFactoryData[key].forEach(item => {
                    const isCritical = item.type === 'Critical';
                    const isWarning = item.type === 'Warning';
                    
                    const div = document.createElement('div');
                    div.className = "card p-4 border-gray-100";
                    
                    div.onclick = () => {
                        if (item.type !== 'Normal') {
                            openDetails(key, item.id);
                        }
                    };

                    div.innerHTML = `
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-bold text-lg">${item.unit}</h3>
                            <span class="px-2 py-1 ${isCritical ? 'bg-red-100 text-red-600' : (isWarning ? 'bg-amber-100 text-amber-600' : 'bg-green-100 text-green-600')} text-[10px] font-bold rounded uppercase">${item.status}</span>
                        </div>
                        <p class="text-sm text-gray-500 mb-3 italic">${item.event}</p>
                        ${item.type !== 'Normal' ? `
                        <div class="flex justify-between items-center ${isCritical ? 'bg-red-50 text-red-700' : 'bg-amber-50 text-amber-700'} p-3 rounded-xl">
                            <span class="text-xs font-semibold">ВРЕМЯ ПРОСТОЯ</span>
                            <span class="text-xl font-black tabular-nums">${item.timer}</span>
                        </div>` : ''}
                    `;
                    container.appendChild(div);
                });
            }
            navigate('workshop');
        }

        function openDetails(workshopKey, unitId) {
            const unit = brestFactoryData[workshopKey].find(u => u.id === unitId);
            if (!unit) return;

            document.getElementById('event-unit').innerText = unit.unit;
            document.getElementById('error-code').innerText = unit.code || 'N/A';
            document.getElementById('event-desc').innerText = unit.desc || '';
            document.getElementById('event-responsible').innerText = unit.resp || 'Дежурный мастер';
            document.getElementById('resp-avatar').innerText = unit.initials || '??';
            document.getElementById('event-time').innerText = unit.log ? unit.log[0][0] : '--:--';

            const badge = document.getElementById('event-badge');
            if (unit.type === 'Critical') {
                badge.className = "mt-2 inline-block px-3 py-1 bg-red-100 text-red-600 text-[10px] font-bold rounded-full uppercase tracking-wider";
                badge.innerText = "Критическая ошибка";
            } else {
                badge.className = "mt-2 inline-block px-3 py-1 bg-amber-100 text-amber-600 text-[10px] font-bold rounded-full uppercase tracking-wider";
                badge.innerText = "Внимание";
            }

            const logContainer = document.getElementById('event-log');
            logContainer.innerHTML = '';
            if (unit.log) {
                unit.log.forEach(entry => {
                    logContainer.innerHTML += `
                        <div class="relative pl-6">
                            <div class="absolute -left-[9px] top-1 w-4 h-4 ${unit.type === 'Critical' ? 'bg-red-500' : 'bg-amber-500'} rounded-full border-2 border-white"></div>
                            <p class="text-[10px] font-bold">${entry[0]}</p>
                            <p class="text-sm text-gray-600">${entry[1]}</p>
                        </div>
                    `;
                });
            }
            navigate('details');
        }
    </script>
</body>
</html>